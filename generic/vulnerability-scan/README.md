# Vulnerability Scanning Composite Action

Runs a vulnerability scan using [Trivy](https://github.com/aquasecurity/trivy-action) on the supplied Docker image. The action will fail if any Critical issues are found.

## Inputs

| Name         | Description                                                  | Required | Default     |
|--------------|--------------------------------------------------------------|----------|-------------|
| docker-image | The Docker image reference to scan.                          | Yes      | N/A         |
| severity     | Comma-separated list of severity levels to scan for.         | No       | CRITICAL    |
| checkout     | Whether to run actions/checkout before scanning.             | No       | true        |

## Usage

```yaml
env:
  IMAGE: eu.gcr.io/extenda/hiiretail-service

jobs:
  ...
  vulnerability-scan:
    runs-on: ubuntu-latest
    steps:
      - uses: extenda/shared-workflows/generic/vulnerability-scan@v0
        with:
          docker-image: ${{ env.IMAGE }}:${{ github.sha }}
          severity: CRITICAL,HIGH
```
